<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEURAL ARCHITECT | Learning OS v4.0</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§ </text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --neon-pink: #f72585;
            --pink-glow: rgba(247, 37, 133, 0.6);
            --neon-blue: #4895ef;
            --bg-dark: #080110;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: var(--bg-dark); color: #f0f0f0; font-family: 'Rajdhani', sans-serif; min-height: 100vh; padding: 15px; overflow-x: hidden; }

        .container { width: 100%; max-width: 1400px; margin: 0 auto; display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 1024px) { .container { grid-template-columns: 360px 1fr; } }

        header { grid-column: 1 / -1; background: var(--glass); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 20px; padding: 25px; text-align: center; border-bottom: 3px solid var(--neon-pink); box-shadow: var(--pink-glow); }
        h1 { font-family: 'Orbitron'; font-size: clamp(1.5rem, 5vw, 2.5rem); letter-spacing: 5px; text-transform: uppercase; color: #fff; text-shadow: 0 0 10px var(--neon-pink); }

        /* Navigation HUD */
        .nav-hud { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }
        .nav-item { background: rgba(255,255,255,0.02); border: 1px solid var(--neon-blue); color: #fff; padding: 15px; border-radius: 12px; cursor: pointer; font-family: 'Orbitron'; font-size: 0.7rem; transition: 0.3s; display: flex; align-items: center; gap: 15px; }
        .nav-item:hover, .nav-item.active { background: var(--neon-blue); color: #000; box-shadow: 0 0 20px var(--neon-blue); }

        .glass-card { background: var(--glass); backdrop-filter: blur(30px); border-radius: 24px; padding: 25px; border: 1px solid var(--glass-border); }

        /* Neural Map Styles */
        .map-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 20px; }
        .subject-node { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 15px; text-align: center; border: 1px solid var(--glass-border); }
        .node-val { font-family: 'Orbitron'; font-size: 1.2rem; color: var(--neon-blue); }
        .node-lab { font-size: 0.6rem; text-transform: uppercase; margin-top: 5px; color: #888; }

        /* Page Management */
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Terminal Output */
        .terminal { background: rgba(0,0,0,0.6); padding: 25px; border-radius: 15px; border-left: 4px solid var(--neon-pink); margin-top: 20px; font-family: 'Share Tech Mono'; line-height: 1.6; }
        
        .btn-neural { width: 100%; background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink)); border: none; color: #fff; padding: 15px; border-radius: 12px; font-family: 'Orbitron'; font-weight: bold; cursor: pointer; text-transform: uppercase; margin-top: 20px; }

        input, select, textarea { width: 100%; background: rgba(0,0,0,0.5); border: 1px solid var(--glass-border); border-radius: 10px; padding: 12px; color: #fff; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Neural Architect</h1>
            <p style="color: var(--neon-blue); letter-spacing: 3px; font-size: 0.7rem;">PERSISTENT LEARNING SYSTEM v4.0</p>
        </header>

        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="nav-hud">
                <div class="nav-item active" onclick="showView('terminal', this)"><i class="fas fa-terminal"></i> CORE TERMINAL</div>
                <div class="nav-item" onclick="showView('map', this)"><i class="fas fa-project-diagram"></i> NEURAL MAP</div>
                <div class="nav-item" onclick="showView('modules', this)"><i class="fas fa-microchip"></i> SUBJECT MODULES</div>
                <div class="nav-item" onclick="showView('homework', this)"><i class="fas fa-file-code"></i> ASSIGNMENTS</div>
            </div>

            <div class="glass-card">
                <h3 style="font-family: 'Orbitron'; font-size: 0.7rem; color: var(--neon-pink);">NEURAL_SYNC</h3>
                <div style="font-size: 2rem; font-family: 'Orbitron'; margin: 10px 0;" id="xpDisplay">0</div>
                <div style="font-size: 0.6rem; color: var(--neon-blue);">TOTAL XP COLLECTED</div>
            </div>
        </aside>

        <!-- Main Workspace -->
        <main class="workspace">
            <div class="glass-card" style="min-height: 600px;">
                
                <!-- View 1: Core Terminal -->
                <section id="view-terminal" class="view-section active">
                    <h3 style="color: var(--neon-blue); font-family: 'Orbitron';"><i class="fas fa-comment-dots"></i> AI Q&A TERMINAL</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <select id="subject"><option value="maths">MATHEMATICS</option><option value="science">SCIENCE</option><option value="geography">GEOGRAPHY</option></select>
                        <select id="level"><option value="foundation">FOUNDATION</option><option value="higher">HIGHER</option></select>
                    </div>
                    <textarea id="question" rows="5" placeholder="Transmit query to Neural Core..."></textarea>
                    <button class="btn-neural" onclick="runAction('chat')">EXECUTE NEURAL LINK</button>
                    <div id="chatOutput" class="terminal" style="display:none;"></div>
                </section>

                <!-- View 2: Neural Map -->
                <section id="view-map" class="view-section">
                    <h3 style="color: var(--neon-blue); font-family: 'Orbitron';"><i class="fas fa-brain"></i> SUBJECT MASTERY MAP</h3>
                    <p style="font-size: 0.8rem; color: #888;">Real-time sync with PostgreSQL interaction logs.</p>
                    <div class="map-grid" id="masteryGrid">
                        <!-- Filled by JS -->
                    </div>
                </section>

                <!-- View 3: Subject Modules -->
                <section id="view-modules" class="view-section">
                    <h3 style="color: var(--neon-blue); font-family: 'Orbitron';"><i class="fas fa-book-open"></i> CURRICULUM EXPLORER</h3>
                    <button class="btn-neural" onclick="runAction('modules')">SCAN SUBJECT FOR MODULES</button>
                    <div id="moduleList" class="terminal" style="display:none;"></div>
                </section>

                <!-- View 4: Assignments -->
                <section id="view-homework" class="view-section">
                    <h3 style="color: var(--neon-blue); font-family: 'Orbitron';"><i class="fas fa-edit"></i> ASSIGNMENT GENERATOR</h3>
                    <input type="text" id="hwTopic" placeholder="Enter topic (e.g. Tectonic Plates)">
                    <button class="btn-neural" onclick="runAction('homework')">GENERATE ASSIGNMENT</button>
                    <div id="hwOutput" class="terminal" style="display:none;"></div>
                </section>

            </div>
        </main>
    </div>

    <script>
        const API_URL = 'https://n8n.srv1090894.hstgr.cloud/webhook/tutor';
        let STUDENT_ID = localStorage.getItem('neural_student_id') || 'ARCH_' + Math.floor(Math.random()*9000);
        localStorage.setItem('neural_student_id', STUDENT_ID);

        // Global State
        let state = { xp: 0, mastery: { maths: 12, science: 45, geography: 5, computing: 0, english: 0 } };

        function showView(viewId, btn) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('view-' + viewId).classList.add('active');
            btn.classList.add('active');
            if(viewId === 'map') renderMap();
        }

        function renderMap() {
            const grid = document.getElementById('masteryGrid');
            grid.innerHTML = '';
            Object.entries(state.mastery).forEach(([sub, val]) => {
                grid.innerHTML += `<div class="subject-node"><div class="node-val">${val}%</div><div class="node-lab">${sub}</div></div>`;
            });
        }

        async function runAction(actionType) {
            const subject = document.getElementById('subject').value;
            const question = document.getElementById('question').value;
            const topic = document.getElementById('hwTopic').value;

            // Simple UI feedback
            const outputs = { chat: 'chatOutput', modules: 'moduleList', homework: 'hwOutput' };
            const outBox = document.getElementById(outputs[actionType]);
            outBox.style.display = 'block';
            outBox.innerHTML = "[INITIATING LINK...]";

            try {
                const payload = {
                    action: actionType,
                    studentId: STUDENT_ID,
                    data: { subject, question, topic }
                };

                const url = `${API_URL}?data=${encodeURIComponent(JSON.stringify(payload))}`;
                const response = await fetch(url);
                const data = await response.json();

                if (data.answer) {
                    outBox.innerHTML = data.answer.replace(/\n/g, '<br>');
                    state.xp += 10;
                    document.getElementById('xpDisplay').innerText = state.xp;
                    if(window.MathJax) MathJax.typesetPromise();
                }
            } catch (e) {
                outBox.innerHTML = "LINK FAILURE: Check n8n workflow.";
            }
        }
    </script>
</body>
</html>
